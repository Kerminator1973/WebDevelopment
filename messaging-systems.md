# Системы доставки сообщений

В сложных web-приложениях, подсистема доставки сообщений имеет ключевое значение.

Ключевой книгой является "Enterprise Integration Patterns" by Gregor Hohpe и Bobby Woolf.

При выборе системы доставки сообщений для web-приложения, следует принять во внимание следующие элементы:

- Направление взаимодействия: **one-way only**, или обмен **request/reply**
- Цель сообщения, которая также определяет его контекст
- Синхронизация (timing) сообщения, т.е. сообщение отправляется/принимается синхронно (in-context), или асинхронно (out-of-context)
- Доставка сообщения, т.е. доставляется ли оно напрямую, или через брокера

## Message Broker

**Message Broker** - это временное хранилище данных между источником (sender) и получателем (receiver). Использование брокера добавляет "уровнень косвенности" между источником события и его получателем, что может упростить конфигурацию системы. Однако, использование broker-а создаёт и дополнительные проблемы:

- ухудшается латентность сетевого соединения
- добавляется ещё одна точка отказа
- при увеличении нагрузки, может потребоваться масштабирование broker-а

Основные протоколы, используемые при работе Broker-ов:

- [MQTT](https://mqtt.org/) - легковесный протокол обмена данными, спроектированный для machine-to-machine communications
- [AMQP](https://www.amqp.org/) - мощный протокол, open source альтернатива проприетарным middleware
- [STOMP](https://stomp.github.io/) - легковесный, text-based протокол

Все три протокола базируются на TCP/IP.
