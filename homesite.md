# Web-сервер в домашней сети

Существует возможность создать публично доступный web-сайт, используя инфраструктуру домашней сети. Затраты на создание такого решения могут быть нулевыми, или быть близки к нулевым.

Провайдер услуг доступа в интернет выделяет динамический IP-адрес каждому из своих пользователей. Чаще всего этот адрес получает маршрутизатор. Для организации публичной доступа к компьютеру в домашней сети необходимо, чтобы маршрутизатор поддерживал функцию **port forwarding**, т.е. при поступлении запроса на входной порт маршрутизатора, пересылал запрос другому компьютеру в домашней сети, которые реализует функцию web-сервера.

Чтобы пользователи интернет могли получать постоянный доступ к компьютеру (маршрутизатору) у которого постоянно изменяется IP-адрес, необходимо задействовать инфраструктуру **DDNS** (Dynamic DNS), которая также должна поддерживаться маршрутизатором.

"Вишенка на торте" - создание бесплатного SSL-сертификата для web-сервера, например, используя сервис **Let's Encrypt**.

## Переадрессация запросов на домашний компьютер

Начать нужно с включения переадрессации на домашнем маршрутизаторе. Для этого нужно зайти под учёной записью администратора и настроить правило **port forwarding**, т.к. переадрессацию входящего запроса. Такая настройка в управляющей консоли администратора может храниться в разделе "NAT-переадрессация" -> "Виртуальные серверы" (справедливо для некоторых моделей TP-Link).

В управляющей консоли домашних маршрутизаторов TP-Link поле "тип сервиса" означает символический идентификатор записи в реестре, которая создаётся лишь для удобства администратора в управлении устройством.

## DDNS - noip.com

Вторая часть задачи - обеспечить возможность переадрессации на динамически изменяемый IP-адрес маршрутизатора по некоторому символическому имени. Эту задачу можно решить  используя **Dynamic-DNS**.

Часто подобная схема применяется для маршрутизаторов домашних сетей. При загрузке, или изменении локального IP-адреса, маршрутизатор отправляет на специализированный сервис свой IP-адрес и credentials. Имя учётной записи на DDNS может использоваться для формирования символического имени компьютера/маршрутизатора, например: _sokoban.hopto.org_. В случае, если сервис (DDNS) будет получать запросы на адрес связанный с учётной записью, он будет переадрессовывать запросы на IP-адрес этого компьютера (маршрутизатора).

Один из наиболее известных сервисов DDNS, у которого есть бесплатный тарифный план: https://www.noip.com/. Компания-разработчик опубликовала открытый протокол, который поддерживают различные маршрутизаторы. После создания учётной записи на сайте NoIP, необходимо активировать функционал привязки маршрутизатора к NoIP в маршрутизаторе и активировать его.

В случае корректной настройки сервер MoIP получит запрос на зарегистрированный адрес (например, sokoban.hopto.org) и переадрессует его на последний известный динамический IP-адрес маршрутизатора.

## Бесплатный SSL-сертификат

Бесплатные сертификаты можно сгенерировать на [Let's Encrypt](https://letsencrypt.org/ru/getting-started/).

## Настройка Raspberry Pi, в качестве публичного web-сервера

Инструкция по применению NoIP для RPi 3/4: [How to Install No-IP on Raspberry Pi](https://www.slicethepi.co.uk/how-to-install-no-ip-on-raspberry-pi/)

Видео-инструкция [Fireship: Raspberry Pi versus AWS // How to host your website on the RPi4](https://www.youtube.com/watch?v=QdHvS0D1zAI)